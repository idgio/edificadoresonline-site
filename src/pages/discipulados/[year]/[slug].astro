---
import BaseLayout from "@/layouts/BaseLayout.astro";
import entries from "@/data/discipulados.json";

type Entry = (typeof entries)[number];

export function getStaticPaths() {
  return entries.map((entry) => ({
    params: { year: entry.year.toString(), slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const monthLabel = entry.month.toUpperCase();
const pageTitle =
  entry.metaTitle ??
  `${entry.month} ${entry.year} - ${entry.title}${entry.subtitle ? `: ${entry.subtitle}` : ""} - Edificadores Online`;
---

<BaseLayout title={pageTitle} headerClass="mb-12">
  <!-- Main Content -->
  <section class="space-y-8">
    <!-- Back Navigation -->
    <div class="flex items-center gap-2 text-sm">
      <a
        href="/discipulados"
        class="text-[#666] hover:text-[#1c1c1c] transition"
        >← Volver a Discipulados</a
      >
    </div>

    <!-- Content Layout -->
    <div class="grid gap-8 lg:grid-cols-2 items-start">
      <!-- Left Side - Content -->
      <div class="space-y-6">
        <div>
          <p class="text-sm font-semibold text-[#666] mb-2">{monthLabel}</p>
          <h1
            class="text-4xl font-bold text-[#1c1c1c] mb-4"
            style="font-family: 'Playfair Display', serif;"
          >
            {entry.title}
          </h1>
          <h2
            class="text-2xl font-bold text-[#2d2d2d] mb-4"
            style="font-family: 'Playfair Display', serif;"
          >
            {entry.subtitle}
          </h2>
        </div>

        <div class="space-y-4 text-[#4a4a4a] leading-relaxed">
          <p class="text-base">{entry.summary}</p>

          <div>
            <p class="font-semibold text-[#2d2d2d] mb-2">
              {entry.verseTitle}
            </p>
            <p class="text-sm italic mb-2">{entry.verseRef}</p>
            <p class="text-sm">{entry.verseText}</p>
          </div>

          <div>
            <p class="font-semibold text-[#2d2d2d] mb-2">Aplicación:</p>
            <p class="text-sm">{entry.application}</p>
          </div>
        </div>

        <!-- Download Buttons -->
        <div class="flex flex-col gap-3">
          {entry.downloads.map((download) => (
            <a
              href={download.url}
              target="_blank"
              rel="noopener noreferrer"
              class="flex items-center gap-2 rounded-full bg-[#1c1c1c] px-6 py-3 text-sm font-semibold text-[#f7f1e7] transition hover:bg-[#0f0f0f] w-fit"
            >
              {download.label}
              <span
                class="grid h-5 w-5 place-items-center rounded-full border border-[#f7f1e7]"
                >→</span
              >
            </a>
          ))}
        </div>
      </div>

      <!-- Right Side - Video -->
      <div class="space-y-4">
        <div class="relative w-full aspect-video rounded-2xl overflow-hidden bg-gray-900">
          <iframe
            class="w-full h-full"
            src={entry.videoUrl}
            title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            referrerpolicy="strict-origin-when-cross-origin"
            allowfullscreen
          ></iframe>
        </div>
      </div>
    </div>

    <!-- Related Months Navigation -->
  </section>
</BaseLayout>
